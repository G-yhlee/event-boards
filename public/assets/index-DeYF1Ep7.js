(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();const Xt=!1;var pt=Array.isArray,xn=Array.prototype.indexOf,mt=Array.from,ft=Object.defineProperty,be=Object.getOwnPropertyDescriptor,Pn=Object.getOwnPropertyDescriptors,kn=Object.prototype,An=Array.prototype,Ht=Object.getPrototypeOf,Rt=Object.isExtensible;const In=()=>{};function Cn(){var t,e,n=new Promise((r,i)=>{t=r,e=i});return{promise:n,resolve:t,reject:e}}const X=2,Vt=4,Rn=8,Ie=16,re=32,_e=64,Wt=128,V=256,Ke=512,L=1024,W=2048,ue=4096,Y=8192,pe=16384,gt=32768,rt=65536,Mt=1<<17,Mn=1<<18,Le=1<<19,On=1<<20,ct=1<<21,yt=1<<22,ve=1<<23,ze=Symbol("$state"),Dn=Symbol("legacy props"),wt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Nn(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Gn(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Fn(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ln(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Bn(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function qn(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Un(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Xn(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Hn(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Vn(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Wn(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const jn=1,Yn=2,zn=16,Kn=1,Zn=2,Jn=4,Qn=8,$n=16,er=1,tr=2,O=Symbol(),nr="http://www.w3.org/1999/xhtml";let rr=!1;function jt(t){return t===this.v}function ir(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Yt(t){return!ir(t,this.v)}let Ce=!1,ar=!1;function sr(){Ce=!0}let C=null;function Ze(t){C=t}function me(t,e=!1,n){C={p:C,c:null,e:null,s:t,x:null,l:Ce&&!e?{s:null,u:null,$:[]}:null}}function ge(t){var e=C,n=e.e;if(n!==null){e.e=null;for(var r of n)sn(r)}return C=e.p,{}}function Be(){return!Ce||C!==null&&C.l===null}const lr=new WeakMap;function ur(t){var e=b;if(e===null)return E.f|=ve,t;if((e.f&gt)===0){if((e.f&Wt)===0)throw!e.parent&&t instanceof Error&&zt(t),t;e.b.error(t)}else bt(t,e)}function bt(t,e){for(;e!==null;){if((e.f&Wt)!==0)try{e.b.error(t);return}catch(n){t=n}e=e.parent}throw t instanceof Error&&zt(t),t}function zt(t){const e=lr.get(t);e&&(ft(t,"message",{value:e.message}),ft(t,"stack",{value:e.stack}))}function or(){for(var t=b.b;t!==null&&!t.has_pending_snippet();)t=t.parent;return t===null&&Nn(),t}function it(t){var e=X|W,n=E!==null&&(E.f&X)!==0?E:null;return b===null||n!==null&&(n.f&V)!==0?e|=V:b.f|=Le,{ctx:C,deps:null,effects:null,equals:jt,f:e,fn:t,reactions:null,rv:0,v:O,wv:0,parent:n??b,ac:null}}function fr(t,e){let n=b;n===null&&Fn();var r=n.b,i=void 0,a=Ne(O),s=null,u=!E;return Sr(()=>{try{var l=t()}catch(d){l=Promise.reject(d)}var o=()=>l;i=s?.then(o,o)??Promise.resolve(l),s=i;var f=D,h=r.pending;u&&(r.update_pending_count(1),h||f.increment());const c=(d,v=void 0)=>{s=null,h||f.activate(),v?v!==wt&&(a.f|=ve,Qe(a,v)):((a.f&ve)!==0&&(a.f^=ve),Qe(a,d)),u&&(r.update_pending_count(-1),h||f.decrement()),Jt()};if(i.then(c,d=>c(null,d||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(l=>{function o(f){function h(){f===i?l(a):o(i)}f.then(h,h)}o(i)})}function ce(t){const e=it(t);return vn(e),e}function Et(t){const e=it(t);return e.equals=Yt,e}function Kt(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)J(e[n])}}function cr(t){for(var e=t.parent;e!==null;){if((e.f&X)===0)return e;e=e.parent}return null}function Tt(t){var e,n=b;se(cr(t));try{Kt(t),e=pn(t)}finally{se(n)}return e}function Zt(t){var e=Tt(t);if(t.equals(e)||(t.v=e,t.wv=hn()),!ye)if(xe!==null)xe.set(t,t.v);else{var n=(ie||(t.f&V)!==0)&&t.deps!==null?ue:L;U(t,n)}}function vr(t,e,n){const r=Be()?it:Et;if(e.length===0){n(t.map(r));return}var i=D,a=b,s=dr(),u=or();Promise.all(e.map(l=>fr(l))).then(l=>{i?.activate(),s();try{n([...t.map(r),...l])}catch(o){(a.f&pe)===0&&bt(o,a)}i?.deactivate(),Jt()}).catch(l=>{u.error(l)})}function dr(){var t=b,e=E,n=C;return function(){se(t),Q(e),Ze(n)}}function Jt(){se(null),Q(null),Ze(null)}const Oe=new Set;let D=null,xe=null,Ot=new Set,Je=[];function Qt(){const t=Je.shift();Je.length>0&&queueMicrotask(Qt),t()}let De=[],St=null,vt=!1;class Pe{current=new Map;#i=new Map;#a=new Set;#e=0;#o=null;#f=!1;#n=[];#s=[];#r=[];#t=[];#l=[];#c=[];#v=[];skipped_effects=new Set;process(e){De=[];var n=null;if(Oe.size>1){n=new Map,xe=new Map;for(const[a,s]of this.current)n.set(a,{v:a.v,wv:a.wv}),a.v=s;for(const a of Oe)if(a!==this)for(const[s,u]of a.#i)n.has(s)||(n.set(s,{v:s.v,wv:s.wv}),s.v=u)}for(const a of e)this.#h(a);if(this.#n.length===0&&this.#e===0){this.#d();var r=this.#r,i=this.#t;this.#r=[],this.#t=[],this.#l=[],D=null,Dt(r),Dt(i),D===null?D=this:Oe.delete(this),this.#o?.resolve()}else this.#u(this.#r),this.#u(this.#t),this.#u(this.#l);if(n){for(const[a,{v:s,wv:u}]of n)a.wv<=u&&(a.v=s);xe=null}for(const a of this.#n)Te(a);for(const a of this.#s)Te(a);this.#n=[],this.#s=[]}#h(e){e.f^=L;for(var n=e.first;n!==null;){var r=n.f,i=(r&(re|_e))!==0,a=i&&(r&L)!==0,s=a||(r&Y)!==0||this.skipped_effects.has(n);if(!s&&n.fn!==null){if(i)n.f^=L;else if((r&Vt)!==0)this.#t.push(n);else if((r&L)===0)if((r&yt)!==0){var u=n.b?.pending?this.#s:this.#n;u.push(n)}else st(n)&&((n.f&Ie)!==0&&this.#l.push(n),Te(n));var l=n.first;if(l!==null){n=l;continue}}var o=n.parent;for(n=n.next;n===null&&o!==null;)n=o.next,o=o.parent}}#u(e){for(const n of e)((n.f&W)!==0?this.#c:this.#v).push(n),U(n,L);e.length=0}capture(e,n){this.#i.has(e)||this.#i.set(e,n),this.current.set(e,e.v)}activate(){D=this}deactivate(){D=null;for(const e of Ot)if(Ot.delete(e),e(),D!==null)break}neuter(){this.#f=!0}flush(){De.length>0?hr():this.#d(),D===this&&(this.#e===0&&Oe.delete(this),this.deactivate())}#d(){if(!this.#f)for(const e of this.#a)e();this.#a.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#c)U(e,W),ke(e);for(const e of this.#v)U(e,ue),ke(e);this.#r=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(e){this.#a.add(e)}settled(){return(this.#o??=Cn()).promise}static ensure(){if(D===null){const e=D=new Pe;Oe.add(D),Pe.enqueue(()=>{D===e&&e.flush()})}return D}static enqueue(e){Je.length===0&&queueMicrotask(Qt),Je.unshift(e)}}function hr(){var t=Ee;vt=!0;try{var e=0;for(Gt(!0);De.length>0;){var n=Pe.ensure();if(e++>1e3){var r,i;_r()}n.process(De),ae.clear()}}finally{vt=!1,Gt(t),St=null}}function _r(){try{Un()}catch(t){bt(t,St)}}let fe=null;function Dt(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var r=t[n++];if((r.f&(pe|Y))===0&&st(r)&&(fe=[],Te(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?on(r):r.fn=null),fe.length>0)){ae.clear();for(const i of fe)Te(i);fe=[]}}fe=null}}function ke(t){for(var e=St=t;e.parent!==null;){e=e.parent;var n=e.f;if(vt&&e===b&&(n&Ie)!==0)return;if((n&(_e|re))!==0){if((n&L)===0)return;e.f^=L}}De.push(e)}const ae=new Map;function Ne(t,e){var n={f:0,v:t,reactions:null,equals:jt,rv:0,wv:0};return n}function N(t,e){const n=Ne(t);return vn(n),n}function pr(t,e=!1,n=!0){const r=Ne(t);return e||(r.equals=Yt),Ce&&n&&C!==null&&C.l!==null&&(C.l.s??=[]).push(r),r}function w(t,e,n=!1){E!==null&&(!K||(E.f&Mt)!==0)&&Be()&&(E.f&(X|Ie|yt|Mt))!==0&&!ne?.includes(t)&&Wn();let r=n?Z(e):e;return Qe(t,r)}function Qe(t,e){if(!t.equals(e)){var n=t.v;ye?ae.set(t,e):ae.set(t,n),t.v=e;var r=Pe.ensure();r.capture(t,n),(t.f&X)!==0&&((t.f&W)!==0&&Tt(t),U(t,(t.f&V)===0?L:ue)),t.wv=hn(),$t(t,W),Be()&&b!==null&&(b.f&L)!==0&&(b.f&(re|_e))===0&&(H===null?kr([t]):H.push(t))}return e}function ut(t){w(t,t.v+1)}function $t(t,e){var n=t.reactions;if(n!==null)for(var r=Be(),i=n.length,a=0;a<i;a++){var s=n[a],u=s.f;if(!(!r&&s===b)){var l=(u&W)===0;l&&U(s,e),(u&X)!==0?$t(s,ue):l&&((u&Ie)!==0&&fe!==null&&fe.push(s),ke(s))}}}function Z(t){if(typeof t!="object"||t===null||ze in t)return t;const e=Ht(t);if(e!==kn&&e!==An)return t;var n=new Map,r=pt(t),i=N(0),a=de,s=u=>{if(de===a)return u();var l=E,o=de;Q(null),Lt(a);var f=u();return Q(l),Lt(o),f};return r&&n.set("length",N(t.length)),new Proxy(t,{defineProperty(u,l,o){(!("value"in o)||o.configurable===!1||o.enumerable===!1||o.writable===!1)&&Hn();var f=n.get(l);return f===void 0?f=s(()=>{var h=N(o.value);return n.set(l,h),h}):w(f,o.value,!0),!0},deleteProperty(u,l){var o=n.get(l);if(o===void 0){if(l in u){const f=s(()=>N(O));n.set(l,f),ut(i)}}else w(o,O),ut(i);return!0},get(u,l,o){if(l===ze)return t;var f=n.get(l),h=l in u;if(f===void 0&&(!h||be(u,l)?.writable)&&(f=s(()=>{var d=Z(h?u[l]:O),v=N(d);return v}),n.set(l,f)),f!==void 0){var c=_(f);return c===O?void 0:c}return Reflect.get(u,l,o)},getOwnPropertyDescriptor(u,l){var o=Reflect.getOwnPropertyDescriptor(u,l);if(o&&"value"in o){var f=n.get(l);f&&(o.value=_(f))}else if(o===void 0){var h=n.get(l),c=h?.v;if(h!==void 0&&c!==O)return{enumerable:!0,configurable:!0,value:c,writable:!0}}return o},has(u,l){if(l===ze)return!0;var o=n.get(l),f=o!==void 0&&o.v!==O||Reflect.has(u,l);if(o!==void 0||b!==null&&(!f||be(u,l)?.writable)){o===void 0&&(o=s(()=>{var c=f?Z(u[l]):O,d=N(c);return d}),n.set(l,o));var h=_(o);if(h===O)return!1}return f},set(u,l,o,f){var h=n.get(l),c=l in u;if(r&&l==="length")for(var d=o;d<h.v;d+=1){var v=n.get(d+"");v!==void 0?w(v,O):d in u&&(v=s(()=>N(O)),n.set(d+"",v))}if(h===void 0)(!c||be(u,l)?.writable)&&(h=s(()=>N(void 0)),w(h,Z(o)),n.set(l,h));else{c=h.v!==O;var m=s(()=>Z(o));w(h,m)}var g=Reflect.getOwnPropertyDescriptor(u,l);if(g?.set&&g.set.call(f,o),!c){if(r&&typeof l=="string"){var T=n.get("length"),y=Number(l);Number.isInteger(y)&&y>=T.v&&w(T,y+1)}ut(i)}return!0},ownKeys(u){_(i);var l=Reflect.ownKeys(u).filter(h=>{var c=n.get(h);return c===void 0||c.v!==O});for(var[o,f]of n)f.v!==O&&!(o in u)&&l.push(o);return l},setPrototypeOf(){Vn()}})}var Nt,en,tn,nn;function mr(){if(Nt===void 0){Nt=window,en=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;tn=be(e,"firstChild").get,nn=be(e,"nextSibling").get,Rt(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Rt(n)&&(n.__t=void 0)}}function qe(t=""){return document.createTextNode(t)}function $e(t){return tn.call(t)}function at(t){return nn.call(t)}function k(t,e){return $e(t)}function gr(t,e){{var n=$e(t);return n instanceof Comment&&n.data===""?at(n):n}}function R(t,e=1,n=!1){let r=t;for(;e--;)r=at(r);return r}function yr(t){t.textContent=""}function rn(){return!1}function an(t){var e=E,n=b;Q(null),se(null);try{return t()}finally{Q(e),se(n)}}function wr(t){b===null&&E===null&&qn(),E!==null&&(E.f&V)!==0&&b===null&&Bn(),ye&&Ln()}function br(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function Re(t,e,n,r=!0){var i=b;i!==null&&(i.f&Y)!==0&&(t|=Y);var a={ctx:C,deps:null,nodes_start:null,nodes_end:null,f:t|W,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Te(a),a.f|=gt}catch(l){throw J(a),l}else e!==null&&ke(a);if(r){var s=a;if(n&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&Le)===0&&(s=s.first),s!==null&&(s.parent=i,i!==null&&br(s,i),E!==null&&(E.f&X)!==0&&(t&_e)===0)){var u=E;(u.effects??=[]).push(s)}}return a}function Er(t){wr();var e=b.f,n=!E&&(e&re)!==0&&(e&gt)===0;if(n){var r=C;(r.e??=[]).push(t)}else return sn(t)}function sn(t){return Re(Vt|On,t,!1)}function Tr(t){Pe.ensure();const e=Re(_e|Le,t,!0);return(n={})=>new Promise(r=>{n.outro?Pt(e,()=>{J(e),r(void 0)}):(J(e),r(void 0))})}function Sr(t){return Re(yt|Le,t,!0)}function he(t,e=[],n=[]){vr(e,n,r=>{Re(Rn,()=>t(...r.map(_)),!0)})}function xt(t,e=0){var n=Re(Ie|e,t,!0);return n}function Ae(t,e=!0){return Re(re|Le,t,!0,e)}function ln(t){var e=t.teardown;if(e!==null){const n=ye,r=E;Ft(!0),Q(null);try{e.call(null)}finally{Ft(n),Q(r)}}}function un(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){const i=n.ac;i!==null&&an(()=>{i.abort(wt)});var r=n.next;(n.f&_e)!==0?n.parent=null:J(n,e),n=r}}function xr(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&re)===0&&J(e),e=n}}function J(t,e=!0){var n=!1;(e||(t.f&Mn)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(Pr(t.nodes_start,t.nodes_end),n=!0),un(t,e&&!n),et(t,0),U(t,pe);var r=t.transitions;if(r!==null)for(const a of r)a.stop();ln(t);var i=t.parent;i!==null&&i.first!==null&&on(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function Pr(t,e){for(;t!==null;){var n=t===e?null:at(t);t.remove(),t=n}}function on(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Pt(t,e){var n=[];kt(t,n,!0),fn(n,()=>{J(t),e&&e()})}function fn(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function kt(t,e,n){if((t.f&Y)===0){if(t.f^=Y,t.transitions!==null)for(const s of t.transitions)(s.is_global||n)&&e.push(s);for(var r=t.first;r!==null;){var i=r.next,a=(r.f&rt)!==0||(r.f&re)!==0;kt(r,e,a?n:!1),r=i}}}function At(t){cn(t,!0)}function cn(t,e){if((t.f&Y)!==0){t.f^=Y,(t.f&L)===0&&(U(t,W),ke(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&rt)!==0||(n.f&re)!==0;cn(n,i?e:!1),n=r}if(t.transitions!==null)for(const a of t.transitions)(a.is_global||e)&&a.in()}}let Ee=!1;function Gt(t){Ee=t}let ye=!1;function Ft(t){ye=t}let E=null,K=!1;function Q(t){E=t}let b=null;function se(t){b=t}let ne=null;function vn(t){E!==null&&(ne===null?ne=[t]:ne.push(t))}let F=null,q=0,H=null;function kr(t){H=t}let dn=1,Ge=0,de=Ge;function Lt(t){de=t}let ie=!1;function hn(){return++dn}function st(t){var e=t.f;if((e&W)!==0)return!0;if((e&ue)!==0){var n=t.deps,r=(e&V)!==0;if(n!==null){var i,a,s=(e&Ke)!==0,u=r&&b!==null&&!ie,l=n.length;if((s||u)&&(b===null||(b.f&pe)===0)){var o=t,f=o.parent;for(i=0;i<l;i++)a=n[i],(s||!a?.reactions?.includes(o))&&(a.reactions??=[]).push(o);s&&(o.f^=Ke),u&&f!==null&&(f.f&V)===0&&(o.f^=V)}for(i=0;i<l;i++)if(a=n[i],st(a)&&Zt(a),a.wv>t.wv)return!0}(!r||b!==null&&!ie)&&U(t,L)}return!1}function _n(t,e,n=!0){var r=t.reactions;if(r!==null&&!ne?.includes(t))for(var i=0;i<r.length;i++){var a=r[i];(a.f&X)!==0?_n(a,e,!1):e===a&&(n?U(a,W):(a.f&L)!==0&&U(a,ue),ke(a))}}function pn(t){var e=F,n=q,r=H,i=E,a=ie,s=ne,u=C,l=K,o=de,f=t.f;F=null,q=0,H=null,ie=(f&V)!==0&&(K||!Ee||E===null),E=(f&(re|_e))===0?t:null,ne=null,Ze(t.ctx),K=!1,de=++Ge,t.ac!==null&&(an(()=>{t.ac.abort(wt)}),t.ac=null);try{t.f|=ct;var h=t.fn,c=h(),d=t.deps;if(F!==null){var v;if(et(t,q),d!==null&&q>0)for(d.length=q+F.length,v=0;v<F.length;v++)d[q+v]=F[v];else t.deps=d=F;if(!ie||(f&X)!==0&&t.reactions!==null)for(v=q;v<d.length;v++)(d[v].reactions??=[]).push(t)}else d!==null&&q<d.length&&(et(t,q),d.length=q);if(Be()&&H!==null&&!K&&d!==null&&(t.f&(X|ue|W))===0)for(v=0;v<H.length;v++)_n(H[v],t);return i!==null&&i!==t&&(Ge++,H!==null&&(r===null?r=H:r.push(...H))),(t.f&ve)!==0&&(t.f^=ve),c}catch(m){return ur(m)}finally{t.f^=ct,F=e,q=n,H=r,E=i,ie=a,ne=s,Ze(u),K=l,de=o}}function Ar(t,e){let n=e.reactions;if(n!==null){var r=xn.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&X)!==0&&(F===null||!F.includes(e))&&(U(e,ue),(e.f&(V|Ke))===0&&(e.f^=Ke),Kt(e),et(e,0))}function et(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)Ar(t,n[r])}function Te(t){var e=t.f;if((e&pe)===0){U(t,L);var n=b,r=Ee;b=t,Ee=!0;try{(e&Ie)!==0?xr(t):un(t),ln(t);var i=pn(t);t.teardown=typeof i=="function"?i:null,t.wv=dn;var a;Xt&&ar&&(t.f&W)!==0&&t.deps}finally{Ee=r,b=n}}}function _(t){var e=t.f,n=(e&X)!==0;if(E!==null&&!K){var r=b!==null&&(b.f&pe)!==0;if(!r&&!ne?.includes(t)){var i=E.deps;if((E.f&ct)!==0)t.rv<Ge&&(t.rv=Ge,F===null&&i!==null&&i[q]===t?q++:F===null?F=[t]:(!ie||!F.includes(t))&&F.push(t));else{(E.deps??=[]).push(t);var a=t.reactions;a===null?t.reactions=[E]:a.includes(E)||a.push(E)}}}else if(n&&t.deps===null&&t.effects===null){var s=t,u=s.parent;u!==null&&(u.f&V)===0&&(s.f^=V)}if(ye){if(ae.has(t))return ae.get(t);if(n){s=t;var l=s.v;return((s.f&L)===0&&s.reactions!==null||mn(s))&&(l=Tt(s)),ae.set(s,l),l}}else if(n){if(s=t,xe?.has(s))return xe.get(s);st(s)&&Zt(s)}if((t.f&ve)!==0)throw t.v;return t.v}function mn(t){if(t.v===O)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(ae.has(e)||(e.f&X)!==0&&mn(e))return!0;return!1}function gn(t){var e=K;try{return K=!0,t()}finally{K=e}}const Ir=-7169;function U(t,e){t.f=t.f&Ir|e}const Cr=["touchstart","touchmove"];function Rr(t){return Cr.includes(t)}const yn=new Set,dt=new Set;function Ue(t){for(var e=0;e<t.length;e++)yn.add(t[e]);for(var n of dt)n(t)}let Bt=null;function je(t){var e=this,n=e.ownerDocument,r=t.type,i=t.composedPath?.()||[],a=i[0]||t.target;Bt=t;var s=0,u=Bt===t&&t.__root;if(u){var l=i.indexOf(u);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var o=i.indexOf(e);if(o===-1)return;l<=o&&(s=l)}if(a=i[s]||t.target,a!==e){ft(t,"currentTarget",{configurable:!0,get(){return a||n}});var f=E,h=b;Q(null),se(null);try{for(var c,d=[];a!==null;){var v=a.assignedSlot||a.parentNode||a.host||null;try{var m=a["__"+r];if(m!=null&&(!a.disabled||t.target===a))if(pt(m)){var[g,...T]=m;g.apply(a,[t,...T])}else m.call(a,t)}catch(y){c?d.push(y):c=y}if(t.cancelBubble||v===e||v===null)break;a=v}if(c){for(let y of d)queueMicrotask(()=>{throw y});throw c}}finally{t.__root=e,delete t.currentTarget,Q(f),se(h)}}}function Mr(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function ht(t,e){var n=b;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function G(t,e){var n=(e&er)!==0,r=(e&tr)!==0,i,a=!t.startsWith("<!>");return()=>{i===void 0&&(i=Mr(a?t:"<!>"+t),n||(i=$e(i)));var s=r||en?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=$e(s),l=s.lastChild;ht(u,l)}else ht(s,s);return s}}function tt(t=""){{var e=qe(t+"");return ht(e,e),e}}function I(t,e){t!==null&&t.before(e)}function le(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??=t.nodeValue)&&(t.__t=n,t.nodeValue=n+"")}function Or(t,e){return Dr(t,e)}const we=new Map;function Dr(t,{target:e,anchor:n,props:r={},events:i,context:a,intro:s=!0}){mr();var u=new Set,l=h=>{for(var c=0;c<h.length;c++){var d=h[c];if(!u.has(d)){u.add(d);var v=Rr(d);e.addEventListener(d,je,{passive:v});var m=we.get(d);m===void 0?(document.addEventListener(d,je,{passive:v}),we.set(d,1)):we.set(d,m+1)}}};l(mt(yn)),dt.add(l);var o=void 0,f=Tr(()=>{var h=n??e.appendChild(qe());return Ae(()=>{if(a){me({});var c=C;c.c=a}i&&(r.$$events=i),o=t(h,r)||{},a&&ge()}),()=>{for(var c of u){e.removeEventListener(c,je);var d=we.get(c);--d===0?(document.removeEventListener(c,je),we.delete(c)):we.set(c,d)}dt.delete(l),h!==n&&h.parentNode?.removeChild(h)}});return Nr.set(o,f),o}let Nr=new WeakMap;function Fe(t,e,n=!1){var r=t,i=null,a=null,s=O,u=n?rt:0,l=!1;const o=(d,v=!0)=>{l=!0,c(v,d)};var f=null;function h(){f!==null&&(f.lastChild.remove(),r.before(f),f=null);var d=s?i:a,v=s?a:i;d&&At(d),v&&Pt(v,()=>{s?a=null:i=null})}const c=(d,v)=>{if(s!==(s=d)){var m=rn(),g=r;if(m&&(f=document.createDocumentFragment(),f.append(g=qe())),s?i??=v&&Ae(()=>v(g)):a??=v&&Ae(()=>v(g)),m){var T=D,y=s?i:a,p=s?a:i;y&&T.skipped_effects.delete(y),p&&T.skipped_effects.add(p),T.add_callback(h)}else h()}};xt(()=>{l=!1,e(o),l||c(null,null)},u)}function It(t,e){return e}function Gr(t,e,n){for(var r=t.items,i=[],a=e.length,s=0;s<a;s++)kt(e[s].e,i,!0);var u=a>0&&i.length===0&&n!==null;if(u){var l=n.parentNode;yr(l),l.append(n),r.clear(),z(t,e[0].prev,e[a-1].next)}fn(i,()=>{for(var o=0;o<a;o++){var f=e[o];u||(r.delete(f.k),z(t,f.prev,f.next)),J(f.e,!u)}})}function Ct(t,e,n,r,i,a=null){var s=t,u={flags:e,items:new Map,first:null};{var l=t;s=l.appendChild(qe())}var o=null,f=!1,h=new Map,c=Et(()=>{var g=n();return pt(g)?g:g==null?[]:mt(g)}),d,v;function m(){Fr(v,d,u,h,s,i,e,r,n),a!==null&&(d.length===0?o?At(o):o=Ae(()=>a(s)):o!==null&&Pt(o,()=>{o=null}))}xt(()=>{v??=b,d=_(c);var g=d.length;if(!(f&&g===0)){f=g===0;var T,y,p,S;if(rn()){var P=new Set,$=D;for(y=0;y<g;y+=1){p=d[y],S=r(p,y);var ee=u.items.get(S)??h.get(S);ee?wn(ee,p,y):(T=bn(null,u,null,null,p,S,y,i,e,n,!0),h.set(S,T)),P.add(S)}for(const[j,A]of u.items)P.has(j)||$.skipped_effects.add(A.e);$.add_callback(m)}else m();_(c)}})}function Fr(t,e,n,r,i,a,s,u,l){var o=e.length,f=n.items,h=n.first,c=h,d,v=null,m=[],g=[],T,y,p,S;for(S=0;S<o;S+=1){if(T=e[S],y=u(T,S),p=f.get(y),p===void 0){var P=r.get(y);if(P!==void 0){r.delete(y),f.set(y,P);var $=v?v.next:c;z(n,v,P),z(n,P,$),ot(P,$,i),v=P}else{var ee=c?c.e.nodes_start:i;v=bn(ee,n,v,v===null?n.first:v.next,T,y,S,a,s,l)}f.set(y,v),m=[],g=[],c=v.next;continue}if(wn(p,T,S),(p.e.f&Y)!==0&&At(p.e),p!==c){if(d!==void 0&&d.has(p)){if(m.length<g.length){var j=g[0],A;v=j.prev;var te=m[0],oe=m[m.length-1];for(A=0;A<m.length;A+=1)ot(m[A],j,i);for(A=0;A<g.length;A+=1)d.delete(g[A]);z(n,te.prev,oe.next),z(n,v,te),z(n,oe,j),c=j,v=oe,S-=1,m=[],g=[]}else d.delete(p),ot(p,c,i),z(n,p.prev,p.next),z(n,p,v===null?n.first:v.next),z(n,v,p),v=p;continue}for(m=[],g=[];c!==null&&c.k!==y;)(c.e.f&Y)===0&&(d??=new Set).add(c),g.push(c),c=c.next;if(c===null)continue;p=c}m.push(p),v=p,c=p.next}if(c!==null||d!==void 0){for(var Me=d===void 0?[]:mt(d);c!==null;)(c.e.f&Y)===0&&Me.push(c),c=c.next;var Ve=Me.length;if(Ve>0){var We=o===0?i:null;Gr(n,Me,We)}}t.first=n.first&&n.first.e,t.last=v&&v.e;for(var lt of r.values())J(lt.e);r.clear()}function wn(t,e,n,r){Qe(t.v,e),t.i=n}function bn(t,e,n,r,i,a,s,u,l,o,f){var h=(l&jn)!==0,c=(l&zn)===0,d=h?c?pr(i,!1,!1):Ne(i):i,v=(l&Yn)===0?s:Ne(s),m={i:v,v:d,k:a,a:null,e:null,prev:n,next:r};try{if(t===null){var g=document.createDocumentFragment();g.append(t=qe())}return m.e=Ae(()=>u(t,d,v,o),rr),m.e.prev=n&&n.e,m.e.next=r&&r.e,n===null?f||(e.first=m):(n.next=m,n.e.next=m.e),r!==null&&(r.prev=m,r.e.prev=m.e),m}finally{}}function ot(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,a=t.e.nodes_start;a!==null&&a!==r;){var s=at(a);i.before(a),a=s}}function z(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function Lr(t,e,...n){var r=t,i=In,a;xt(()=>{i!==(i=e())&&(a&&(J(a),a=null),a=Ae(()=>i(r,...n)))},rt)}const qt=[...` 	
\r\f \v\uFEFF`];function Br(t,e,n){var r=t==null?"":""+t;if(n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var a=i.length,s=0;(s=r.indexOf(i,s))>=0;){var u=s+a;(s===0||qt.includes(r[s-1]))&&(u===r.length||qt.includes(r[u]))?r=(s===0?"":r.substring(0,s))+r.substring(u+1):s=u}}return r===""?null:r}function Xe(t,e,n,r,i,a){var s=t.__className;if(s!==n||s===void 0){var u=Br(n,r,a);u==null?t.removeAttribute("class"):t.className=u,t.__className=n}else if(a&&i!==a)for(var l in a){var o=!!a[l];(i==null||o!==!!i[l])&&t.classList.toggle(l,o)}return a}const qr=Symbol("is custom element"),Ur=Symbol("is html");function Xr(t,e){var n=En(t);n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Hr(t,e,n,r){var i=En(t);i[e]!==(i[e]=n)&&(n==null?t.removeAttribute(e):typeof n!="string"&&Vr(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function En(t){return t.__attributes??={[qr]:t.nodeName.includes("-"),[Ur]:t.namespaceURI===nr}}var Ut=new Map;function Vr(t){var e=Ut.get(t.nodeName);if(e)return e;Ut.set(t.nodeName,e=[]);for(var n,r=t,i=Element.prototype;i!==r;){n=Pn(r);for(var a in n)n[a].set&&e.push(a);r=Ht(r)}return e}let Ye=!1;function Wr(t){var e=Ye;try{return Ye=!1,[t(),Ye]}finally{Ye=e}}function Se(t,e,n,r){var i=!Ce||(n&Zn)!==0,a=(n&Qn)!==0,s=(n&$n)!==0,u=r,l=!0,o=()=>(l&&(l=!1,u=s?gn(r):r),u),f;if(a){var h=ze in t||Dn in t;f=be(t,e)?.set??(h&&e in t?p=>t[e]=p:void 0)}var c,d=!1;a?[c,d]=Wr(()=>t[e]):c=t[e],c===void 0&&r!==void 0&&(c=o(),f&&(i&&Xn(),f(c)));var v;if(i?v=()=>{var p=t[e];return p===void 0?o():(l=!0,p)}:v=()=>{var p=t[e];return p!==void 0&&(u=void 0),p===void 0?u:p},i&&(n&Jn)===0)return v;if(f){var m=t.$$legacy;return(function(p,S){return arguments.length>0?((!i||!S||m||d)&&f(S?v():p),p):v()})}var g=!1,T=((n&Kn)!==0?it:Et)(()=>(g=!1,v()));a&&_(T);var y=b;return(function(p,S){if(arguments.length>0){const P=S?_(T):i&&a?Z(p):p;return w(T,P),g=!0,u!==void 0&&(u=P),p}return ye&&g||(y.f&pe)!==0?T.v:_(T)})}function jr(t){C===null&&Gn(),Ce&&C.l!==null?Yr(C).m.push(t):Er(()=>{const e=gn(t);if(typeof e=="function")return e})}function Yr(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const zr="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(zr);sr();const Kr=(t,e)=>{!e.value&&e.onclick&&e.onclick(e.position)};var Zr=G("<button> </button>");function Jr(t,e){me(e,!0);var n=Zr();let r;n.__click=[Kr,e];var i=k(n);he(a=>{r=Xe(n,1,"cell svelte-1mvy7wu",null,r,a),n.disabled=!!e.value,le(i,e.value||"")},[()=>({x:e.value==="X",o:e.value==="O"})]),I(t,n),ge()}Ue(["click"]);var Qr=G('<div class="board svelte-1wnjg88"></div>');function $r(t,e){me(e,!0);var n=Qr();Ct(n,21,()=>e.board,It,(r,i,a)=>{Jr(r,{get value(){return _(i)},position:a,get onclick(){return e.onCellClick}})}),I(t,n),ge()}var ei=G("<div> </div>");function ti(t,e){let n=ce(()=>e.status==="waiting"?'Click "Start Game" to begin':e.winner?`Player ${e.winner} wins!`:e.isDraw?"It's a draw!":e.status==="playing"?`Player ${e.currentPlayer}'s turn`:"");var r=ei();let i;var a=k(r);he(s=>{i=Xe(r,1,"status svelte-ojh1vj",null,i,s),le(a,_(n))},[()=>({winner:!!e.winner,draw:e.isDraw})]),I(t,r)}var ni=G("<button><!></button>");function nt(t,e){let n=Se(e,"variant",3,"primary");var r=ni();let i;r.__click=function(...s){e.onclick?.apply(this,s)};var a=k(r);Lr(a,()=>e.children),he(s=>i=Xe(r,1,"button svelte-8qsxg3",null,i,s),[()=>({primary:n()==="primary",secondary:n()==="secondary"})]),I(t,r)}Ue(["click"]);var ri=G('<div class="controls svelte-576gd1"><!> <!></div>');function ii(t,e){var n=ri(),r=k(n);{var i=u=>{nt(u,{get onclick(){return e.onStartGame},children:o=>{var f=tt("Start New Game");I(o,f)},$$slots:{default:!0}})};Fe(r,u=>{e.canStart&&u(i)})}var a=R(r,2);{var s=u=>{nt(u,{get onclick(){return e.onResetGame},variant:"secondary",children:o=>{var f=tt("Reset Game");I(o,f)},$$slots:{default:!0}})};Fe(a,u=>{e.canReset&&u(s)})}I(t,n)}var ai=G('<span class="branch-indicator svelte-ou1vgi">⚡</span>'),si=G('<button><span class="event-number svelte-ou1vgi"> <!></span> <span class="event-type svelte-ou1vgi"> </span> <span class="event-time svelte-ou1vgi"> </span></button>'),li=G('<div class="event-list svelte-ou1vgi"><h3 class="svelte-ou1vgi">Event History</h3> <div class="events svelte-ou1vgi"></div></div>');function ui(t,e){me(e,!0);let n=Se(e,"events",19,()=>[]),r=Se(e,"currentEventIndex",19,()=>-1),i=Se(e,"branches",19,()=>[]);const a=l=>{switch(l.eventType){case"GameStarted":return"Game Started";case"MoveMade":const o=l.payload.player,f=l.payload.position,h=Math.floor(f/3)+1,c=f%3+1;return`Player ${o} → (${h}, ${c})`;case"GameWon":return`Player ${l.payload.winner} Won!`;case"GameDrawn":return"Game Draw";case"GameReset":return"Game Reset";default:return l.eventType}};var s=li(),u=R(k(s),2);Ct(u,21,n,It,(l,o,f)=>{const h=ce(()=>i().some(A=>A.index===f)),c=ce(()=>e.currentBranchPoint===f),d=ce(()=>f<=r()),v=ce(()=>f>r());var m=si();let g;m.__click=()=>e.onEventClick?.(f);var T=k(m),y=k(T);y.nodeValue=`${f+1} `;var p=R(y);{var S=A=>{var te=ai();I(A,te)};Fe(p,A=>{_(h)&&A(S)})}var P=R(T,2),$=k(P),ee=R(P,2),j=k(ee);he((A,te,oe)=>{g=Xe(m,1,"event svelte-ou1vgi",null,g,A),m.disabled=!e.onEventClick,le($,te),le(j,oe)},[()=>({"move-x":_(o).eventType==="MoveMade"&&_(o).payload.player==="X","move-o":_(o).eventType==="MoveMade"&&_(o).payload.player==="O",active:_(d),future:_(v),"has-branch":_(h),"branch-point":_(c)}),()=>a(_(o)),()=>new Date(_(o).occurredAt).toLocaleTimeString()]),I(l,m)}),I(t,s),ge()}Ue(["click"]);const oi=(t,e)=>{const n=t.target,r=parseInt(n.value);e.onReplayToEvent(r)};var fi=G('<span class="event-type svelte-10lo1l6"> </span>'),ci=G('<div class="controls svelte-10lo1l6"><input type="range" min="0" class="slider svelte-10lo1l6"/> <div class="event-info svelte-10lo1l6"> <!></div></div> <div class="navigation svelte-10lo1l6"><!> <!></div>',1),vi=G('<p class="empty svelte-10lo1l6">No events to replay yet. Start playing!</p>'),di=G('<div class="time-travel svelte-10lo1l6"><h3 class="svelte-10lo1l6">Time Travel Debugger</h3> <!></div>');function hi(t,e){me(e,!0);let n=Se(e,"events",19,()=>[]),r=Se(e,"isReplaying",3,!1);var i=di(),a=R(k(i),2);{var s=l=>{var o=ci(),f=gr(o),h=k(f);h.__change=[oi,e];var c=R(h,2),d=k(c),v=R(d);{var m=p=>{var S=fi(),P=k(S);he(()=>le(P,`(${n()[e.currentEventIndex].eventType??""})`)),I(p,S)};Fe(v,p=>{n()[e.currentEventIndex]&&p(m)})}var g=R(f,2),T=k(g);nt(T,{onclick:()=>e.onReplayToEvent(Math.max(0,e.currentEventIndex-1)),variant:"secondary",children:S=>{var P=tt("← Previous");I(S,P)},$$slots:{default:!0}});var y=R(T,2);nt(y,{onclick:()=>e.onReplayToEvent(Math.min(n().length-1,e.currentEventIndex+1)),variant:"secondary",children:S=>{var P=tt("Next →");I(S,P)},$$slots:{default:!0}}),he(()=>{Hr(h,"max",n().length-1),Xr(h,e.currentEventIndex),h.disabled=r(),le(d,`Event ${e.currentEventIndex+1} of ${n().length??""} `)}),I(l,o)},u=l=>{var o=vi();I(l,o)};Fe(a,l=>{n().length>0?l(s):l(u,!1)})}I(t,i),ge()}Ue(["change"]);var _i=(t,e,n)=>e.onSelectTimeline(_(n).id),pi=G('<button><span class="timeline-name svelte-skzyao"> </span> <span class="event-count svelte-skzyao"> </span></button>'),mi=G('<div class="timeline-selector svelte-skzyao"><h3 class="svelte-skzyao">Timelines</h3> <div class="timelines svelte-skzyao"></div></div>');function gi(t,e){me(e,!0);const n=a=>a.id==="main"?"🌍 Main Timeline":a.branchPoint!==void 0?`⚡ ${a.name} (from event ${a.branchPoint+1})`:a.name;var r=mi(),i=R(k(r),2);Ct(i,21,()=>e.timelines,It,(a,s)=>{var u=pi();let l;u.__click=[_i,e,s];var o=k(u),f=k(o),h=R(o,2),c=k(h);he((d,v)=>{l=Xe(u,1,"timeline svelte-skzyao",null,l,d),le(f,v),le(c,`${_(s).events.length??""} events`)},[()=>({active:_(s).id===e.currentTimelineId}),()=>n(_(s))]),I(a,u)}),I(t,r),ge()}Ue(["click"]);class yi{timelines=new Map;currentTimelineId;subscribers=[];eventSubscribers=[];constructor(){const e={id:"main",name:"Main Timeline",events:[],createdAt:new Date().toISOString()};this.timelines.set("main",e),this.currentTimelineId="main"}append(e){const n=this.getCurrentTimeline();return n.events.push(e),this.notifyEventSubscribers(e),this.notifyTimelineSubscribers(n),e}createBranch(e,n,r){const i=this.timelines.get(e);if(!i)throw new Error(`Timeline ${e} not found`);const a=`branch-${Date.now()}`,s={id:a,name:r||`Branch from ${i.name}`,events:[...i.events.slice(0,n+1)],parentTimelineId:e,branchPoint:n,createdAt:new Date().toISOString()};return this.timelines.set(a,s),this.currentTimelineId=a,this.notifyTimelineSubscribers(s),a}switchTimeline(e){if(!this.timelines.has(e))throw new Error(`Timeline ${e} not found`);this.currentTimelineId=e,this.notifyTimelineSubscribers(this.getCurrentTimeline())}getCurrentTimeline(){const e=this.timelines.get(this.currentTimelineId);if(!e)throw new Error("Current timeline not found");return e}getAllTimelines(){return Array.from(this.timelines.values())}getEvents(e,n=0){return this.getCurrentTimeline().events.filter(i=>i.aggregateId===e&&i.version>n).sort((i,a)=>i.version-a.version)}getAllEvents(){return[...this.getCurrentTimeline().events]}subscribe(e){return this.eventSubscribers.push(e),()=>{this.eventSubscribers=this.eventSubscribers.filter(n=>n!==e)}}subscribeToTimelines(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter(n=>n!==e)}}notifyEventSubscribers(e){this.eventSubscribers.forEach(n=>n(e))}notifyTimelineSubscribers(e){this.subscribers.forEach(n=>n(e))}clear(){this.timelines.clear();const e={id:"main",name:"Main Timeline",events:[],createdAt:new Date().toISOString()};this.timelines.set("main",e),this.currentTimelineId="main"}getCurrentTimelineId(){return this.currentTimelineId}}class wi{id;version=0;uncommittedEvents=[];constructor(e){this.id=e}applyEvent(e){const n=`on${e.eventType}`,r=this[n];typeof r=="function"&&r.call(this,e),this.version=e.version}raiseEvent(e){e.version=this.version+1,this.applyEvent(e),this.uncommittedEvents.push(e)}markEventsAsCommitted(){this.uncommittedEvents=[]}getUncommittedEvents(){return[...this.uncommittedEvents]}loadFromHistory(e){e.forEach(n=>this.applyEvent(n))}getId(){return this.id}getVersion(){return this.version}}class He{id;aggregateId;eventType;payload;metadata;occurredAt;version;constructor(e,n,r,i={}){this.id=crypto.randomUUID(),this.aggregateId=e,this.eventType=n,this.payload=r,this.metadata=i,this.occurredAt=new Date().toISOString(),this.version=1}}class bi extends He{constructor(e,n,r){super(e,"GameStarted",{playerX:n,playerO:r,board:Array(9).fill(null),currentPlayer:"X"})}}class Ei extends He{constructor(e,n,r,i){super(e,"MoveMade",{player:n,position:r,board:[...i]})}}class Ti extends He{constructor(e,n,r){super(e,"GameWon",{winner:n,winningLine:r})}}class Si extends He{constructor(e){super(e,"GameDrawn",{})}}class xi extends He{constructor(e){super(e,"GameReset",{})}}class _t extends wi{board=Array(9).fill(null);currentPlayer=null;winner=null;isDraw=!1;playerX=null;playerO=null;status="waiting";constructor(e){super(e)}startGame(e,n){if(this.status!=="waiting"&&this.status!=="finished")throw new Error("Game already started");const r=new bi(this.id,e,n);this.raiseEvent(r)}makeMove(e,n){if(this.status!=="playing")throw new Error("Game is not in progress");if(e!==this.currentPlayer)throw new Error("Not your turn");if(n<0||n>8)throw new Error("Invalid position");if(this.board[n]!==null)throw new Error("Position already taken");const r=[...this.board];r[n]=e;const i=new Ei(this.id,e,n,r);this.raiseEvent(i);const a=this.checkWinner(r);if(a){const s=new Ti(this.id,e,a);this.raiseEvent(s)}else if(this.isBoardFull(r)){const s=new Si(this.id);this.raiseEvent(s)}}reset(){const e=new xi(this.id);this.raiseEvent(e)}onGameStarted(e){this.board=e.payload.board,this.currentPlayer=e.payload.currentPlayer,this.playerX=e.payload.playerX,this.playerO=e.payload.playerO,this.status="playing",this.winner=null,this.isDraw=!1}onMoveMade(e){this.board=e.payload.board,this.currentPlayer=this.currentPlayer==="X"?"O":"X"}onGameWon(e){this.winner=e.payload.winner,this.status="finished"}onGameDrawn(e){this.isDraw=!0,this.status="finished"}onGameReset(e){this.board=Array(9).fill(null),this.currentPlayer="X",this.winner=null,this.isDraw=!1,this.status="playing"}checkWinner(e){const n=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const r of n){const[i,a,s]=r;if(e[i]&&e[i]===e[a]&&e[i]===e[s])return r}return null}isBoardFull(e){return e.every(n=>n!==null)}getState(){return{id:this.id,board:[...this.board],currentPlayer:this.currentPlayer,winner:this.winner,isDraw:this.isDraw,playerX:this.playerX,playerO:this.playerO,status:this.status,version:this.version}}}class Pi{constructor(e){this.eventStore=e}async handle(e){const n=await this.loadAggregate(e.aggregateId);switch(e.type){case"StartGame":n.startGame(e.payload.playerX,e.payload.playerO);break;case"MakeMove":n.makeMove(e.payload.player,e.payload.position);break;case"ResetGame":n.reset();break;default:throw new Error(`Unknown command type: ${e.type}`)}return n.getUncommittedEvents().forEach(i=>this.eventStore.append(i)),n.markEventsAsCommitted(),n.getState()}async loadAggregate(e){const n=new _t(e),r=this.eventStore.getEvents(e);return n.loadFromHistory(r),n}}var ki=G('<div class="game-template svelte-1o4q7sd"><div class="game-area svelte-1o4q7sd"><h1 class="svelte-1o4q7sd">Event Sourcing Tic-Tac-Toe</h1> <!> <!> <!></div> <div class="sidebar svelte-1o4q7sd"><!> <!> <!></div></div>');function Ai(t,e){me(e,!0);const n=new yi,r=new Pi(n);let i=crypto.randomUUID(),a=N(Z({id:i,board:Array(9).fill(null),currentPlayer:null,winner:null,isDraw:!1,playerX:null,playerO:null,status:"waiting",version:0})),s=N(Z([])),u=N(-1),l=N(!1),o=N(Z([])),f=N("main"),h=N(Z([])),c=N(void 0);n.subscribe(x=>{w(s,n.getAllEvents(),!0),w(u,_(s).length-1)}),n.subscribeToTimelines(x=>{w(o,n.getAllTimelines(),!0),w(f,n.getCurrentTimelineId(),!0),d()});const d=()=>{const x=new Map;_(o).forEach(M=>{M.branchPoint!==void 0&&x.set(M.branchPoint,(x.get(M.branchPoint)||0)+1)}),w(h,Array.from(x.entries()).map(([M,Sn])=>({index:M,count:Sn})),!0);const B=_(o).find(M=>M.id===_(f));w(c,B?.branchPoint,!0)},v=async()=>{const x={type:"StartGame",aggregateId:i,payload:{playerX:"X",playerO:"O"}},B=await r.handle(x);w(a,B,!0)},m=async x=>{if(_(a).status!=="playing")return;const B={type:"MakeMove",aggregateId:i,payload:{player:_(a).currentPlayer,position:x}};try{const M=await r.handle(B);w(a,M,!0)}catch(M){console.error("Move error:",M instanceof Error?M.message:M)}},g=async()=>{i=crypto.randomUUID(),n.clear(),w(s,[],!0),w(u,-1),w(o,[n.getCurrentTimeline()],!0),w(f,"main"),w(h,[],!0),w(c,void 0),w(a,{id:i,board:Array(9).fill(null),currentPlayer:null,winner:null,isDraw:!1,playerX:null,playerO:null,status:"waiting",version:0},!0)},T=async x=>{if(x<-1||x>=_(s).length)return;w(l,!0),w(u,x,!0);const B=new _t(i);if(x>=0){const M=_(s).slice(0,x+1);B.loadFromHistory(M)}w(a,B.getState(),!0),w(l,!1)},y=async x=>{await T(x)},p=async x=>{if(_(a).status==="playing"){if(_(u)<_(s).length-1){const B=`Timeline from event ${_(u)+2}`,M=n.createBranch(_(f),_(u),B);w(s,n.getAllEvents(),!0),w(f,M,!0)}await m(x)}},S=x=>{n.switchTimeline(x),w(s,n.getAllEvents(),!0),w(f,x,!0),w(u,_(s).length-1);const B=new _t(i);B.loadFromHistory(_(s)),w(a,B.getState(),!0)};let P=ce(()=>_(a).status==="waiting"||_(a).status==="finished"),$=ce(()=>_(a).status==="finished"||_(a).status==="playing"&&_(s).length>1);jr(()=>{w(o,n.getAllTimelines(),!0),w(f,n.getCurrentTimelineId(),!0),d()});var ee=ki(),j=k(ee),A=R(k(j),2);ti(A,{get currentPlayer(){return _(a).currentPlayer},get winner(){return _(a).winner},get isDraw(){return _(a).isDraw},get status(){return _(a).status}});var te=R(A,2);$r(te,{get board(){return _(a).board},onCellClick:p});var oe=R(te,2);ii(oe,{onStartGame:v,onResetGame:g,get canStart(){return _(P)},get canReset(){return _($)}});var Me=R(j,2),Ve=k(Me);gi(Ve,{get timelines(){return _(o)},get currentTimelineId(){return _(f)},onSelectTimeline:S});var We=R(Ve,2);ui(We,{get events(){return _(s)},get currentEventIndex(){return _(u)},onEventClick:y,get branches(){return _(h)},get currentBranchPoint(){return _(c)}});var lt=R(We,2);hi(lt,{get events(){return _(s)},onReplayToEvent:T,get isReplaying(){return _(l)},get currentEventIndex(){return _(u)},set currentEventIndex(x){w(u,x,!0)}}),I(t,ee),ge()}var Ii=G("<main><!></main>");function Ci(t){var e=Ii(),n=k(e);Ai(n,{}),I(t,e)}const Tn=document.getElementById("app");if(!Tn)throw new Error("Could not find app element");Or(Ci,{target:Tn});
